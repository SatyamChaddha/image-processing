% vim:ft=tex
% rubber: module xelatex
\subsection{Rectification}
\label{sec:rectification-prior}

Image rectification is based on the calibration work. The calibration gives:

\begin{itemize}
\item $T_l,T_r$, translation vectors from the calibration object to the left resp
  right camera origin, in the camera references.

\item $R_l,R_r$, rotation matrices from the calibration object reference system to
  the left resp right camera reference systems.

\item $f$, the focal length.
\end{itemize}

From these the following values are computed:

\begin{itemize}
\item $R=R_lR_r^{-1}$, the rotation matrix from the right to the left reference
  frame.

\item $T=RT_r-T_l$, the translation vector from the left to the right camera
  origin, in the left camera reference.

\item $R_{rect}$, the rectification rotation matrix. This is computed by
  creating an orthonormal base using $T$ as the new $X$ vector, $Y$ as cross
  product of the unit vector in the $Z$ axis direction with $X$, and $Z$ as the
  cross product of $X$ and $Y$ (all normalised to unit length).
\end{itemize}

From these values, the rectification is computed so that the left image is
rectified by $R_{rect}$ and the right image is rectified b $RR_{rect}$. The
rectification coordinates are computed by getting the pixel values as
three-dimensional coordinates, with the $z$ component being the focal length,
and then applying the rectification matrices. The values are then multiplied by
$f/z$, so that the new values are again at focal $z$ values. The OpenCV remap()
function is used to do the actual remapping of pixels, and interpolation
(bicubic interpolation in a 4x4 neighbourhood is used).
